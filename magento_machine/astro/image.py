# -*- coding: utf8 -*-
#!/usr/bin/python
import csv
import os

noImage = ['00-24W','01-110C','01017474','01017474','01541500','01542500','01861990','01866990','01912300','04509300','04519300','04519971','04528850','05009951','05017982','05025604','05030600','05119951','05502990','05528000','05528500','05528600','05528603','05528850','05528970','05528972','05528980','05528990','05559000','05819950','05865973','05872630','06020410','06020411','06030410','06507011','06507601','06527601','06542100','08020960','08030960','09007606','09012970','09017606','09017970','09025606','09025970','09502606','09502970','09507606','09507801','09513970','09523970','09527606','09527801','09528970','09533970','09559606','09559970','09806606','09806970','09811606','09812970','09813606','09813970','09821970','09824606','09825970','09826606','09826970','09839606','09839970','09844606','09844970','09847970','09865606','09865970','09870606','09870970','09871970','09872606','09872970','09879970','09889606','09889970','09894606','09894970','09895606','09895970','100-80T',100007351,100009001,100017351,100020001,100129001,100222001,'10022220S',100527010,104009990,104119350,104129300,104507000,104509000,104509200,104802310,104808310,104816310,104820310,104824400,104826400,104836310,104841310,104861310,104865600,104866310,10509200,10519200,109007442,109007552,109017442,109020414,109025401,109030442,109222414,109222442,10952601,10952604,10952606,10952607,10952608,10952609,10952610,109802600,109808600,109816600,109818000,109818100,109820600,109825503,109825606,109866600,110009350,110009850,110119350,110119850,111030510,111030630,111030951,111030960,11119200,111560961,111808973,111820973,111836973,111841000,111841973,111848510,111848971,111866973,111896640,112020450,112119010,112129450,112222450,'113-137C',113009011,113020850,113040300,113129011,113222300,113527510,113529010,113811510,113826101,114017400,114020000,114020014,114025014,114025104,114030000,114030014,114502400,114528400,114808100,114813002,114814100,114821400,114824400,114826400,114843000,114861100,114872401,114881100,118007991,118017991,118020992,118025991,118025997,118030992,120020450,120025601,120030450,12007100,120527400,120829450,120829952,121507001,127017500,14007004,14009008,14017115,14020201,14025004,14030111,14030201,14541119,14738009,14810009,14828009,15528400,15568130,16009002,16129002,16222010,163839000,163839980,16507000,168023006,169007000,17011080,171021001,171021008,171021011,171021013,171022001,171022008,171022011,171022013,171023001,171023006,171023007,171023008,171024001,171024006,171024007,171024008,172007006,172007008,172009006,172009008,172021001,172022001,172022008,172023001,172023006,172023007,172023008,172024008,172501007,172501008,172509007,172509008,18009028,18009080,18017280,18129028,18129080,18507101,18507200,18509000,18509020,18519000,18519020,18527200,18529000,18529020,19009950,19012028,19020000,19020013,19020130,19025010,19025450,19025518,19030013,19030510,19119002,19119950,19312028,19507170,19507310,19509480,19511180,19519480,19527170,19531180,19738080,19801000,19805990,19807000,19812990,19826081,19829000,19837028,19866080,19871480,19871528,19871990,19872051,19873080,19879480,19879528,19879990,20007400,20009450,20020025,20020230,20025280,20030025,20030230,20119450,20501037,20507070,20507107,20521080,20527070,20529037,20542000,20847028,20871028,21017400,21025520,21523400,21528520,21533400,21559520,21800400,21811400,'23-108T','23-129C','27-111C',27017980,'28-12PT',28009850,28119850,'30-24W','30-24W-EPS','30-84C',30007010,30102000,30102200,30102400,30102410,30106000,30106100,30106200,30106410,30527000,30528000,30803000,30803100,30804000,30804100,30811000,30817100,30818200,30862000,30862100,30863000,30863100,30863200,30870000,30870100,30872100,31007028,31007110,'33-24W-EPSL',35007450,35017450,36009990,36012510,36012980,36012990,36119510,36119980,36129990,36312510,36312980,36312990,'36501800GL',36509510,36519510,37222036,37541036,37542036,38017000,38020400,38025000,38030400,38501000,38501100,38507000,38507010,38507100,38509000,38519000,38529000,41119450,41824000,41843850,41863850,41870000,43012859,43022859,43025001,43129451,43222855,43312859,43511853,43520000,43520451,43520851,43520852,43529852,43530960,43531850,43541450,43542450,43820452,43825851,43825852,43834630,43866850,43884851,45810200,46007852,46025852,48501,48501010,48502400,48502403,48502407,48502502,48502505,48502530,48502531,48502620,48502631,48502801,48502981,48502992,48513602,5101706,51502100,51818000,51818211,51818510,51823000,51823211,51823510,51836400,51839100,51840400,51841400,52017410,52025001,53025521,60025001,60129001,60502501,60509960,60528501,60560501,60821501,60825501,61020970,61030970,61559510,'62007020CM','62007030CM','62050783B',62507030,62507110,62507450,62509030,62509300,62529030,62529300,63009000,63020000,63030000,63119000,65030010,66839001,66839101,66847001,66865101,'6800700E','6800711E','6801700e',68030120,'6812201E','6812202E','6812211E','6850101E','6850111S',68509100,'6851701E',69020991,69025110,69542100,69891310,70025951,'7050210B','7050240B',70819020,72007011,72501011,73040000,73122850,73129802,73129950,73221850,73222020,73523854,73529000,73529100,73529450,73529501,73529850,73602410,73800952,73813852,73821350,73843956,73872351,73884851,73891854,73893854,'74-104C','74-111C','74-222C',74017100,75009003,75020003,75030003,75129003,75222003,77542001,'78-100C-F','78-110C-F','78-80C','7800911F','7802000F','7812900F','7822200F','7850100V','7850900V','7850910V','7850911V','7851910V','7851911V',78806000,78819000,'7883901V',78865000,79020500,79030500,'82-130CB',82017130,82017400,'83-113C-CEMENT','83-93C-BRASILIA','94-110C',96020501,96030501,96119350,96222501,96222990,96527350,96527500,97009001,97020011,97119001,97222011,'ABGRG120','ABOGO260','ABOOR120','APTMR188','CCDAB28','CCDAW108','CCLPB320','CLCBR','CLDSW235','CLNAW485','CLNSW485','CLWAB101','COMEG365','COPAG732','COPIS475','EAMPCESW320','FFIDBW103','FFIDBW129','FFIDBW189','FFIDBW236','FFIDBW308','FFUSBW140','FFUSBW160','FFUSBW200','FFUSBW260','FFUSBW320','FFUSBW400','FFUSBW520','FFUSBW640','FGBLT','FGBLT140','FGCBV','FGCBV140','FGCHA','FGCHA140','FOSBW102','FOSBW119','FOSBW120','FOSBW136','FOSBW140','FOSBW160','FOSBW169','FOSBW200','FOSBW260','FOSBW320','FOSBW400','FOVBW102','FOVBW119','FOVBW120','FOVBW136','FOVBW140','FOVBW160','FOVBW169','FOVBW200','FOVBW260','FOVBW320','FOVBW400','G925AS433','GCLC','MCLFG320','MISGT172','MISSI357','MVLBW140','MVLBWI92','NFB-125C','NFBDB478','NP222017','PLNAT310','RRBWH160','some_product_1','Test0011','TOUPE492']

source = open('image.csv', 'rb')
result = open('result.csv', 'w')

result.write('ItemCode,PicturName,path,hasImage,updated\n')

for row in csv.reader(source, delimiter = ','):

    sku = row[0]
    fileName = row[1]
    path = ''
    hasImage = False
    updated = False

    if fileName is not None and len(fileName.strip()) > 0 and 'null' not in fileName.lower():
        path = '/home/devop/' + fileName

        if os.path.exists(path):
            hasImage = True

            if sku in noImage:
                updated = True

                fileNameRenamed = fileName.lower().strip().replace(' ', '_').replace('\'', '_').replace('%', '')
                pathRenamed = '/home/devop/renamed/' + fileNameRenamed
                print 'INSERT INTO e_product_image (sku, image_url, image_type, sync_status, sync_dt, sync_notes) VALUES ("{}", "{}", "image,small_image,thumbnail,swatch_image", "N", NOW(), "{}") ON DUPLICATE KEY UPDATE sync_status = "N", sync_dt = NOW(), sync_notes = "{}";'.format(sku, fileNameRenamed, pathRenamed, pathRenamed)

    result.write('{},{},{},{},{}\n'.format(sku, fileName, path, hasImage, updated))

source.close()
result.close()

